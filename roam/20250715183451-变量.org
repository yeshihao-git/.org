:PROPERTIES:
:ID:       4276f9fb-4b68-4c73-bd8f-8a7c1e5f82a9
:END:
#+title: 变量
#+filetags: cpp

* 变量
- 对象 :: 有类型的存储区域

- 变量 :: 有名字的对象。分为：
  1. [[id:9d854181-28ea-4165-9459-f1a5f2b94cf8][局部变量]]
  2. [[id:f9f2f226-ff42-49b7-8f28-c1eb4957b71b][全局变量]]

#+name: 变量总结
|---------------------+----------------------------------+---------------------------------+--------+--------+--------+--------------------|
|                     | 类型                             | 示例                            | 作用域 | 链接性 | 存储期 | 说明               |
|---------------------+----------------------------------+---------------------------------+--------+--------+--------+--------------------|
| 局部变量            | 局部变量                         | int x;                          | 块     | 无     | 自动   |                    |
|                     | static 局部变量                  | static int s_x;                 | 块     | 无     | 静态   |                    |
|                     | 动态局部变量                     | int* x { new int{} };           | 块     | 无     | 动态   |                    |
|                     | 函数参数                         | void foo(int x)                 | 块     | 无     | 自动   |                    |
|---------------------+----------------------------------+---------------------------------+--------+--------+--------+--------------------|
| 全局变量（非const） | 内部 非const 全局变量            | static int g_x;                 | 全局   | 内部   | 静态   | 初始化 或 未初始化 |
|                     | 外部 非const 全局变量            | int g_x;                        | 全局   | 外部   | 静态   | 初始化 或 未初始化 |
|                     | inline 非const 全局变量（C++17） | inline int g_x;                 | 全局   | 外部   | 静态   | 初始化 或 未初始化 |
|---------------------+----------------------------------+---------------------------------+--------+--------+--------+--------------------|
| 全局变量（const）   | 内部 const 全局变量              | constexpr int g_x { 1 };        | 全局   | 内部   | 静态   | 必须初始化         |
|                     | 外部 const 全局变量              | extern const int g_x { 1 };     | 全局   | 外部   | 静态   | 必须初始化         |
|                     | inline const 全局变量（C++17）   | inline constexpr int g_x { 1 }; | 全局   | 外部   | 静态   | 必须初始化         |
|---------------------+----------------------------------+---------------------------------+--------+--------+--------+--------------------|
[[id:853a3bee-b823-49fc-acd6-804eecb74822][存储期、作用域、链接性]]


** 局部变量
:PROPERTIES:
:ID:       9d854181-28ea-4165-9459-f1a5f2b94cf8
:END:
- 局部变量 :: 定义在函数中的变量（包括函数参数）
  1. 块作用域，无链接性，自动存储期
  2. *默认初始化* 为随机值
  3. 销毁按 *创建的逆序* 销毁 [fn:1]


** 全局变量
:PROPERTIES:
:ID:       f9f2f226-ff42-49b7-8f28-c1eb4957b71b
:END:
- 全局变量 :: 定义在函数外部的变量
  1. 全局作用域，外部链接性，静态存储期

  *最佳实践*
  1. 全局变量 定义在 命名空间（而不是全局命名空间）
  2. 尽量不使用全局变量


* Footnotes

[fn:1]
#+begin_src cpp
int add(int x, int y) {
  int z{ x + y };
  return z;
} // 此处销毁，顺序 z、y、x
#+end_src
